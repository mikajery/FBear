<%= language_prompt %>

<%= simple_form_for [:admin, @good], :html => { :class => 'form-horizontal' } do |f| %>
  <%= form_errors f %>

  <%= tabs [[:main, 'Основное'], 
      [:pictures, 'Картинки'], 
      [:options, 'Варианты'], 
      [:tech, 'Характеристики'], 
      [:descriptions, 'Описания'], 
      [:pdfs, 'PDF', {disabled: (true unless @good.id)}], 
      [:three60, '360-просмотр', {disabled: (true unless @good.id)}], 
      [:video, 'Видео'], 
      [:meta, 'META']] %>

  <%= tab_contents do %>
    <%= tab_pane :main, {active: true} do %>
      <%= f.input :name %>

      <%= f.input :slug if @good.id? %>

      <% Globalize.with_locale(@locale.slug) do %>
        <%= f.input :price %>
      <% end %>

      <%= f.association :good_category %>
      <%= f.association :designer %>
      <%= f.association :material %>

      <%= f.input :bg, collection: {'темный' => 'dark', 'светлый' => 'light'}, include_blank: false %>
      <%= f.association :goods, collection: Good.all.select{|g| g != @good} %>

      <% Globalize.with_locale(@locale.slug) do %>
        <%= f.association :tags %>
      <% end %>
    <% end %>

    <%= tab_pane :pictures do %>
      <%= f.input :picture_alignment, collection: get_alignments.map{|k, v| [v, k]}, include_blank: false %>
      <%= image_field @good, 'picture', f, [100, 100] %>
      <%= image_field @good, 'portrait', f, [100, 100] %>
      <%= image_field @good, 'landscape', f, [100, 100] %>

      <hr />

      <%= image_field @good, 'thumb', f, [100, 100] %>
      <%= image_field @good, 'logo', f, [100, 100], transparent: true %>
      <%= image_field @good, 'logo_desc', f, [100, 100], transparent: true %>

      <hr />

      <%= image_field @good, 'panorama', f, [100, 100] %>
      <%= image_field @good, 'panorama_ipad', f, [100, 100] %>
    <% end %>

    <%= tab_pane :pdfs do %>
      <% if @good.pdfs.empty? %>
        <div class="well">
          Опаньки.. Ни одного PDF-файла не найдено..
        </div>
      <% else %>
        <table class="table table-hover">
          <thead>
            <tr>
              <th>
                Файл
              </th>
              <th width="30%" class="center">
                Размер
              </th>
              <th width="60px">
              </th>
            </tr>
          </thead>
          <tbody>
            <% @good.pdfs.each do |pdf| %>
              <tr>
                <td>
                  <% Globalize.with_locale(@locale.slug) do %>
                    <i class="icon icon-file"></i> <%= pdf.name %>
                    <%= content_tag :div, content_tag(:small, pdf.filename), class: 'muted' if pdf.src %>
                  <% end %>
                </td>
                <td class="center">
                  <%= number_to_human_size pdf.size %>
                </td>
                <td>
                  <%= link_to pencil_icon,
                      edit_admin_pdf_path(pdf), :class => 'btn btn-mini' %>
                  <%= link_to trash_icon(true),
                      admin_pdf_path(pdf),
                      :method => :delete,
                      :data => { :confirm => t('.confirm', :default => t("helpers.links.confirm", :default => 'Are you sure?')) },
                      :class => 'btn btn-mini btn-danger' %>
                </td>
              </tr>
            <% end %>
          </tbody>
        </table>
      <% end %>

      <%= link_to (content_tag :i, '', class: 'icon icon-file') + ' Добавить файл',
          new_admin_good_pdf_path(@good),
          :data => { :confirm => t('.confirm', :default => t("helpers.links.confirm", :default => 'Произойдет переход на другую страницу. Вы действительно хотите продолжить?')) }, :class => 'btn' %>

    <% end %>

    <%= tab_pane :options do %>
      <% if @good.options.empty? %>
        <div class="well">
          Опаньки.. Ни одной опции не найдено..
        </div>
      <% else %>
        <table class="table table-hover">
          <thead>
            <tr>
              <th>
                Файл
              </th>
              <th>
                Цена
              </th>
              <th width="60px"></th>
            </tr>
          </thead>
          <tbody>
            <% @good.options.each do |option| %>
              <tr>
                <td>
                  <% Globalize.with_locale(@locale.slug) do %>
                    <%= option.name %>
                  <% end %>
                </td>

                <td>
                  <% Globalize.with_locale(@locale.slug) do %>
                    <%= option.price %>
                  <% end %>
                </td>

                <td>
                  <%= link_to pencil_icon,
                      edit_admin_good_option_path(option), :class => 'btn btn-mini' %>
                  <%= link_to trash_icon(true),
                      admin_good_option_path(option),
                      :method => :delete,
                      :data => { :confirm => t('.confirm', :default => t("helpers.links.confirm", :default => 'Are you sure?')) },
                      :class => 'btn btn-mini btn-danger' %>
                </td>
              </tr>
            <% end %>
          </tbody>
        </table>
      <% end %>

      <%= link_to (content_tag :i, '', class: 'icon icon-file') + ' Добавить файл',
          new_admin_good_good_option_path(@good),
          :data => { :confirm => t('.confirm', :default => t("helpers.links.confirm", :default => 'Произойдет переход на другую страницу. Вы действительно хотите продолжить?')) }, :class => 'btn' %>

    <% end %>

    <%= tab_pane :three60 do %>
      <% if @good.three60s.empty? %>
        <div class="well">
          Опаньки.. Ни одного 3D-просмотра не найдено..
        </div>
      <% else %>
        <table class="table table-hover">
          <thead>
            <tr>
              <th>
                Файл
              </th>
              <th class="center">
                Кадров
              </th>
              <th width="60px">
              </th>
            </tr>
          </thead>
          <tbody>
            <% @good.three60s.each do |three60| %>
              <tr>
                <% if three60.is_uploaded %>
                  <td>
                    <%= with_pic three60, three60.src, :thumb %>
                  </td>
                  <td class="center">
                    <%= three60.items.size %>
                  </td>
                  <td>
                    <%= link_to pencil_icon,
                        edit_admin_three60_path(three60), :class => 'btn btn-mini' %>
                    <%= link_to trash_icon(true),
                        admin_three60_path(three60),
                        :method => :delete,
                        :data => { :confirm => t('.confirm', :default => t("helpers.links.confirm", :default => 'Are you sure?')) },
                        :class => 'btn btn-mini btn-danger' %>
                  </td>
                <% else %>
                  <td colspan="2">
                    <div class="muted">
                      <i class="icon"></i> &laquo;<%= three60.name %>&raquo; загружается...
                    </div>
                  </td>
                  <td>
                    <%= link_to trash_icon(true),
                        admin_three60_path(three60),
                        :method => :delete,
                        :data => { :confirm => t('.confirm', :default => t("helpers.links.confirm", :default => 'Are you sure?')) },
                        :class => 'btn btn-mini btn-danger' %>
                  </td>
                <% end %>
              </tr>
            <% end %>
          </tbody>
        </table>
      <% end %>

      <%= link_to (content_tag :i, '', class: 'icon icon-book') + ' Добавить 3D-просмотр',
          new_admin_good_three60_path(@good),
          :data => { :confirm => t('.confirm', :default => t("helpers.links.confirm", :default => 'Произойдет переход на другую страницу. Вы действительно хотите продолжить?')) }, :class => 'btn' %>

    <% end %>

    <%= tab_pane :video do %>
      <%= f.input :vimeo %>
    <% end %>

    <%= tab_pane :meta do %>
      <% Globalize.with_locale(@locale.slug) do %>
        <%= f.input :title %>
        <%= f.input :heading %>
        <%= f.input :keywords %>
        <%= f.input :description %>
      <% end %>
    <% end %>

    <%= tab_pane :tech do %>
      <%= f.input :width %>
      <%= f.input :height %>
      <%= f.input :depth %>
      <%= f.input :box_width %>
      <%= f.input :box_height %>
      <%= f.input :box_depth %>

      <%= f.input :is_electrical %>
    <% end %>

    <%= tab_pane :descriptions do %>
      <% Globalize.with_locale(@locale.slug) do %>
        <%= f.input :announce, as: :html %>
        <%= f.input :content, as: :html %>
        <%= f.input :additional, as: :html %>
      <% end %>
    <% end %>
  <% end %>

  <%= language_input f %>

  <div class="form-actions">
    <%= f.button :submit, save_or_update(@good), :class => 'btn-primary' %>
    <%= link_to t('.cancel', :default => t("helpers.links.cancel")),
        admin_good_categories_path, :class => 'btn' %>
  </div>
<% end %>
